[{"path":"http://GabrielHoffman.github.io/imputez/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gabriel Hoffman. Author, maintainer.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hoffman G (2025). imputez: Impute z-Statistics Missing Tests using Observed z-Statistics Correlation Matrix z-Statistics. R package version 1.2.1, https://GabrielHoffman.github.io/imputez.","code":"@Manual{,   title = {imputez: Impute z-Statistics for Missing Tests using Observed z-Statistics and the Correlation Matrix Between z-Statistics},   author = {Gabriel Hoffman},   year = {2025},   note = {R package version 1.2.1},   url = {https://GabrielHoffman.github.io/imputez}, }"},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Impute z-Statistics for Missing Tests using Observed z-Statistics and the Correlation Matrix Between z-Statistics","text":"","code":"devtools::install_github(\"GabrielHoffman/imputez\")"},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"create-ld-files","dir":"","previous_headings":"","what":"Create LD files","title":"Impute z-Statistics for Missing Tests using Observed z-Statistics and the Correlation Matrix Between z-Statistics","text":"","code":"FILE=/sc/arion/projects/roussp01a/sanan/230322_GWASimp/imputeZPipeline_V2/inter/230424/plinkStep2/1kg_chr22 OUT=/sc/arion/scratch/hoffmg01/chr22  # Need large window since variants are dropped KB=1000000  # Compute LD with adjacent variants NVARIANTS=1000  # Filter by allele frequency since # imputation does work for variants that are  # rate in the reference panel MAF=0.01   plink --bfile $FILE --maf $MAF --r gz --ld-window 1000 --ld-window-kb $KB --ld-window-r2 0 --threads 12 --out $OUT"},{"path":[]},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"read-in-z-statistics-and-ld-information","dir":"","previous_headings":"Test imputation","what":"Read in z-statistics and LD information","title":"Impute z-Statistics for Missing Tests using Observed z-Statistics and the Correlation Matrix Between z-Statistics","text":"","code":"# devtools::install_github(\"GabrielHoffman/imputez\") library(imputez) library(data.table) library(Matrix)  # read z-statistics file = \"/sc/arion/projects/roussp01a/sanan/230322_GWASimp/imputeZPipeline_V2/exampleForGabriel/GWAS_Zscores_corrected/Bellenguez_AD_chr22.tsv\" df_z_obs = fread(file)  # Specify locations of bim and ld files for each chromosome # This example uses a data frame with 1 row # for real analysis use rows for 1:22 df = data.frame(chrom = 22) df$BIM = \"/sc/arion/projects/roussp01a/sanan/230322_GWASimp/imputeZPipeline_V2/inter/230424/plinkStep2/1kg_chr22.bim\" df$LD = \"/sc/arion/scratch/hoffmg01/chr22.ld.gz\"  # read LD info LDm = readLDMatrix( df )  # LDm = readRDS(\"/sc/arion/scratch/hoffmg01/LDm_chr22.RDS\") # store as RDS to reduce loading time in the future # saveRDS(LDm, file=\"/sc/arion/scratch/hoffmg01/LDm_chr22.RDS\")"},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"perform-imputation-on-observed-z-statistics","dir":"","previous_headings":"Test imputation","what":"Perform imputation on observed z-statistics.","title":"Impute z-Statistics for Missing Tests using Observed z-Statistics and the Correlation Matrix Between z-Statistics","text":"good check pipeline works subset observed variants.","code":"# Create vector with z-statistics and variant names # the z-statistics must be sorted by chromosome location z = df_z_obs$Z names(z) = df_z_obs$SNP  # Run z-statistic imputation on one chromosome df_z = run_imputez(z, LDm[['22']], names(z)[1:1000])"},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"plot-comparing-observed-and-imputed-values","dir":"","previous_headings":"Test imputation","what":"Plot comparing observed and imputed values","title":"Impute z-Statistics for Missing Tests using Observed z-Statistics and the Correlation Matrix Between z-Statistics","text":"","code":"library(ggplot2)  df = data.frame(df_z, z.orig = z[df_z$ID])  r = with(df, cor(z.orig, z.stat))  ggplot(df, aes(z.orig, z.stat, color=r2.pred)) +         geom_point() +         theme_classic() +         theme(aspect.ratio=1, plot.title = element_text(hjust = 0.5)) +         geom_abline(color=\"red\") +          xlab(\"Observed z\") +          ylab(\"Imputed z\") +          ggtitle(\"Compare observed and imputed\") +         scale_color_gradient(low=\"lightblue\", high=\"black\", limits=c(0,1)) +         annotate(geom=\"text\", x=-2, y=2, label=paste0(\"R=\",format(r, digits=4)))"},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"additional-plots","dir":"","previous_headings":"Test imputation","what":"Additional plots","title":"Impute z-Statistics for Missing Tests using Observed z-Statistics and the Correlation Matrix Between z-Statistics","text":"","code":"plot(df_z$width, abs(z[df_z$ID]-df_z$z.stat))  plot(df_z$r2.pred, abs(z[df_z$ID]-df_z$z.stat))"},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"impute-unobserved-z-statistics","dir":"","previous_headings":"Test imputation","what":"Impute unobserved z-statistics","title":"Impute z-Statistics for Missing Tests using Observed z-Statistics and the Correlation Matrix Between z-Statistics","text":"","code":"# get variant IDs LD reference panel but not in z-statistics ids_impute = LDm[['22']]$dfld[!SNP_A %in% names(z),unique(SNP_A)]  df_z = run_imputez(z, LDm[['22']], ids_impute)"},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"impute-directly-from-correlation-matrix","dir":"","previous_headings":"","what":"Impute directly from correlation matrix","title":"Impute z-Statistics for Missing Tests using Observed z-Statistics and the Correlation Matrix Between z-Statistics","text":"","code":"# imputez(z, Sigma, id)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/constructLD.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct LD matrix from data.table — constructLD","title":"Construct LD matrix from data.table — constructLD","text":"Construct LD matrix data.table","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/constructLD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct LD matrix from data.table — constructLD","text":"","code":"constructLD(dfld, ids)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/constructLD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct LD matrix from data.table — constructLD","text":"dfld data.table storing LD information ids variant names include","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/constructLD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct LD matrix from data.table — constructLD","text":"sparseMatrix storing LD variants","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate lambda shrinkage parameter — estimate_lambda","title":"Estimate lambda shrinkage parameter — estimate_lambda","text":"Estimate lambda shrinkage parameter specified method","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate lambda shrinkage parameter — estimate_lambda","text":"","code":"estimate_lambda(   X,   method = c(\"Ledoit-Wolf\", \"OAS\", \"Touloumis\", \"Schafer-Strimmer\", \"Pseudoinverse\") )"},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate lambda shrinkage parameter — estimate_lambda","text":"X matrix features columns method method used estimate lambda shrinkage parameter","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate lambda shrinkage parameter — estimate_lambda","text":"estimated lambda value","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate lambda shrinkage parameter — estimate_lambda","text":"","code":"n = 100 p = 400  X = matrix(rnorm(n*p), n, p)  estimate_lambda(X, \"Ledoit-Wolf\") #> [1] 0.9777997"},{"path":"http://GabrielHoffman.github.io/imputez/reference/fillRate.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute fill rate of sparse matrix — fillRate","title":"Compute fill rate of sparse matrix — fillRate","text":"Compute fill rate sparse matrix","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/fillRate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute fill rate of sparse matrix — fillRate","text":"","code":"fillRate(M)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/fillRate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute fill rate of sparse matrix — fillRate","text":"M sparseMatrix","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/fillRate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute fill rate of sparse matrix — fillRate","text":"fraction entries non-zero","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.eclairs.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute z-score based correlations — imputez.eclairs","title":"Impute z-score based correlations — imputez.eclairs","text":"Impute z-score missing test based z-scores tests, genotype matrix","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.eclairs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute z-score based correlations — imputez.eclairs","text":"","code":"imputez.eclairs(z, X, i, lambda = NULL)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.eclairs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute z-score based correlations — imputez.eclairs","text":"z vector observed z-scores X matrix genotype data reference panel index z-scores impute lambda (default: NULL) value used shrink correlation matrix","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.eclairs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute z-score based correlations — imputez.eclairs","text":"data.frame storing: ID variant identifier z.stat imputed z-statistic sigSq variance imputed z-statistic r2.pred metric accuracy imputed z-statistic based variance lambda correlation shrinkage parameter","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.eclairs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Impute z-score based correlations — imputez.eclairs","text":"Uses implicit covariance emprical Bayes shrinkage eigen-values accelerate computations. imputez() cubic number features, p, imputez.eclairs()  minimum O(n p^2) O(n^2p).  large number features, can dramatic speedup.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.eclairs.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute z-score based correlations — imputez.eclairs","text":"pasaniuc2014fastimputez","code":""},{"path":[]},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute z-score based correlations — imputez","title":"Impute z-score based correlations — imputez","text":"Impute z-score missing test based z-scores tests, correlation matrix z-scores","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute z-score based correlations — imputez","text":"","code":"imputez(z, Sigma, i, lambda = 0.1)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute z-score based correlations — imputez","text":"z vector observed z-scores Sigma matrix correlation z-scores index z-scores impute lambda value used shrink correlation matrix","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute z-score based correlations — imputez","text":"data.frame storing: ID variant identifier z.stat imputed z-statistic sigSq variance imputed z-statistic r2.pred metric accuracy imputed z-statistic based variance","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Impute z-score based correlations — imputez","text":"Implements method Pasaniuc, et al. (2014).","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute z-score based correlations — imputez","text":"Pasaniuc, B., Zaitlen, N., Shi, H., Bhatia, G., Gusev, ., Pickrell, J., ... & Price, . L. (2014). Fast accurate imputation summary statistics enhances evidence functional enrichment. Bioinformatics, 30(20), 2906-2914.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute z-score based correlations — imputezDecorr","title":"Impute z-score based correlations — imputezDecorr","text":"Impute z-score missing test based z-scores tests, genotype matrix","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute z-score based correlations — imputezDecorr","text":"","code":"imputezDecorr(z, X, i, k, lambda = NULL)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute z-score based correlations — imputezDecorr","text":"z vector observed z-scores X matrix genotype data reference panel index z-scores impute k rank SVD lambda (default: NULL) value used shrink correlation matrix","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute z-score based correlations — imputezDecorr","text":"data.frame storing: ID variant identifier z.stat imputed z-statistic sigSq variance imputed z-statistic r2.pred metric accuracy imputed z-statistic based variance lambda correlation shrinkage parameter","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Impute z-score based correlations — imputezDecorr","text":"Uses implicit covariance emprical Bayes shrinkage eigen-values accelerate computations. imputez() cubic number features, p, imputezDecorr()  minimum O(n p^2) O(n^2p).  large number features, can dramatic speedup.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute z-score based correlations — imputezDecorr","text":"Pasaniuc, B., Zaitlen, N., Shi, H., Bhatia, G., Gusev, ., Pickrell, J., ... & Price, . L. (2014). Fast accurate imputation summary statistics enhances evidence functional enrichment. Bioinformatics, 30(20), 2906-2914.","code":""},{"path":[]},{"path":"http://GabrielHoffman.github.io/imputez/reference/pairwiseCompleteWindow.html","id":null,"dir":"Reference","previous_headings":"","what":"Get complete subset of correlation matrix — pairwiseCompleteWindow","title":"Get complete subset of correlation matrix — pairwiseCompleteWindow","text":"Get complete subset correlation matrix entries zero","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/pairwiseCompleteWindow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get complete subset of correlation matrix — pairwiseCompleteWindow","text":"","code":"pairwiseCompleteWindow(S, mid)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/pairwiseCompleteWindow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get complete subset of correlation matrix — pairwiseCompleteWindow","text":"S correlation matrix mid index target variant","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/pairwiseCompleteWindow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get complete subset of correlation matrix — pairwiseCompleteWindow","text":"begin end indeces completely filled matrixq","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/readLDMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Read plink LD files — readLDMatrix","title":"Read plink LD files — readLDMatrix","text":"Read LD files generated plink list sparseMatrix chromosome","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/readLDMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read plink LD files — readLDMatrix","text":"","code":"readLDMatrix(df_files)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/readLDMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read plink LD files — readLDMatrix","text":"df_files data.frame file info: chrom, BIM, LD","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/readLDMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read plink LD files — readLDMatrix","text":"list one entry per chromosome C.ld storing LD correlation matrix gr_position storing variant information","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute many z-statistics — run_analysis","title":"Impute many z-statistics — run_analysis","text":"Impute many z-statistics given observed z-statistics reference panel","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute many z-statistics — run_analysis","text":"","code":"run_analysis(   targets,   df,   gds,   window = 1e+05,   lambda = NULL,   method = c(\"decorrelate\", \"Ledoit-Wolf\", \"OAS\", \"Touloumis\", \"Schafer-Strimmer\",     \"Pseudoinverse\"),   quiet = FALSE )"},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute many z-statistics — run_analysis","text":"targets variant ID's impute df data.frame columns ID, z, GWAS_A1, GWAS_A2, chrom, position A1, A2. gds GenomicDataStream reference panel window size window bp lambda shrinkage parameter used LD matrix.  Defaults lambda = NULL estimated data method method used estimate shrinkage parameter lambda.  default \"decorrelate\" quiet suppress messages","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute many z-statistics — run_analysis","text":"data.frame storing imputed results: ID variant identifier z.stat imputed z-statistic sigSq variance imputed z-statistic r2.pred metric accuracy imputed z-statistic based variance lambda shrinkage parameter maf minor allele frequency reference panel nVariants number variants used imputation","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_analysis.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Impute many z-statistics — run_analysis","text":"Implements method Pasaniuc, et al. (2014).","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_analysis.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute many z-statistics — run_analysis","text":"Pasaniuc, B., Zaitlen, N., Shi, H., Bhatia, G., Gusev, ., Pickrell, J., ... & Price, . L. (2014). Fast accurate imputation summary statistics enhances evidence functional enrichment. Bioinformatics, 30(20), 2906-2914.","code":""},{"path":[]},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute many z-statistics — run_imputez","title":"Impute many z-statistics — run_imputez","text":"Impute many z-statistics given observed z-statistics data.table LD.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute many z-statistics — run_imputez","text":"","code":"run_imputez(z, LDinfo, IDs, maxWindowSize = 200, quiet = FALSE)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute many z-statistics — run_imputez","text":"z vector observed z-statistics unobserved storing value NA LDinfo list data.table storing LD information, GRanges position info IDs variant names z impute maxWindowSize max window size around target variant keep quiet default FALSE.  TRUE, suppress progress bar","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute many z-statistics — run_imputez","text":"data.frame storing imputed results: ID variant identifier z.stat imputed z-statistic sigSq variance imputed z-statistic r2.pred metric accuracy imputed z-statistic based variance width number SNPs LD panel used imputation","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Impute many z-statistics — run_imputez","text":"Implements method Pasaniuc, et al. (2014).","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute many z-statistics — run_imputez","text":"Pasaniuc B, Zaitlen N, Shi H, Bhatia G, Gusev , Pickrell J, Hirschhorn J, Strachan DP, Patterson N, Price AL (2014). “Fast accurate imputation summary statistics enhances evidence functional enrichment.” Bioinformatics, 30(20), 2906--2914.","code":""},{"path":[]}]
