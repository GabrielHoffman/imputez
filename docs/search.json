[{"path":"http://GabrielHoffman.github.io/imputez/articles/beta_approx.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Approximating logistic coefficients","text":"","code":"## R version 4.4.2 (2024-10-31) ## Platform: aarch64-apple-darwin23.6.0 ## Running under: macOS Sonoma 14.7.1 ##  ## Matrix products: default ## BLAS:   /Users/gabrielhoffman/prog/R-4.4.2/lib/libRblas.dylib  ## LAPACK: /opt/homebrew/Cellar/r/4.5.1/lib/R/lib/libRlapack.dylib;  LAPACK version 3.12.1 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/New_York ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ##  [1] cowplot_1.1.3   lubridate_1.9.4 forcats_1.0.0   stringr_1.5.1   ##  [5] dplyr_1.1.4     purrr_1.0.4     readr_2.1.5     tidyr_1.3.1     ##  [9] tibble_3.3.0    ggplot2_3.5.2   tidyverse_2.0.0 imputez_1.2.3   ##  ## loaded via a namespace (and not attached): ##   [1] Rdpack_2.6.4                rlang_1.1.6                 ##   [3] magrittr_2.0.3              matrixStats_1.5.0           ##   [5] compiler_4.4.2              systemfonts_1.2.3           ##   [7] vctrs_0.6.5                 pkgconfig_2.0.3             ##   [9] crayon_1.5.3                fastmap_1.2.0               ##  [11] XVector_0.46.0              labeling_0.4.3              ##  [13] CholWishart_1.1.4           rmarkdown_2.29              ##  [15] tzdb_0.5.0                  pracma_2.4.4                ##  [17] UCSC.utils_1.2.0            ragg_1.4.0                  ##  [19] xfun_0.52                   Rfast_2.1.5.1               ##  [21] zlibbioc_1.52.0             cachem_1.1.0                ##  [23] beachmat_2.22.0             GenomeInfoDb_1.42.3         ##  [25] jsonlite_2.0.0              progress_1.2.3              ##  [27] rhdf5filters_1.18.1         DelayedArray_0.32.0         ##  [29] Rhdf5lib_1.28.0             irlba_2.3.5.1               ##  [31] parallel_4.4.2              prettyunits_1.2.0           ##  [33] R6_2.6.1                    bslib_0.9.0                 ##  [35] stringi_1.8.7               RColorBrewer_1.1-3          ##  [37] GenomicRanges_1.58.0        jquerylib_0.1.4             ##  [39] Rcpp_1.0.14                 SummarizedExperiment_1.36.0 ##  [41] iterators_1.0.14            knitr_1.50                  ##  [43] CovTools_0.5.4              base64enc_0.1-3             ##  [45] IRanges_2.40.1              timechange_0.3.0            ##  [47] Matrix_1.7-3                igraph_2.1.4                ##  [49] tidyselect_1.2.1            abind_1.4-8                 ##  [51] yaml_2.3.10                 doParallel_1.0.17           ##  [53] codetools_0.2-20            minpack.lm_1.2-4            ##  [55] lattice_0.22-7              withr_3.0.2                 ##  [57] Biobase_2.66.0              evaluate_1.0.4              ##  [59] desc_1.4.3                  geigen_2.3                  ##  [61] RcppParallel_5.1.10         pillar_1.10.2               ##  [63] MatrixGenerics_1.18.1       ShrinkCovMat_1.4.0          ##  [65] foreach_1.5.2               SHT_0.1.9                   ##  [67] stats4_4.4.2                generics_0.1.4              ##  [69] S4Vectors_0.44.0            hms_1.1.3                   ##  [71] scales_1.4.0                flare_1.7.0.2               ##  [73] glue_1.8.0                  GenomicDataStream_0.0.60    ##  [75] scatterplot3d_0.3-44        tools_4.4.2                 ##  [77] beachmat.hdf5_1.4.0         fs_1.6.6                    ##  [79] mvtnorm_1.3-3               rgl_1.3.18                  ##  [81] rhdf5_2.50.2                grid_4.4.2                  ##  [83] rbibutils_2.3               GenomeInfoDbData_1.2.13     ##  [85] HDF5Array_1.34.0            cli_3.6.5                   ##  [87] zigg_0.0.2                  textshaping_1.0.1           ##  [89] expm_1.0-0                  S4Arrays_1.6.0              ##  [91] corpcor_1.6.10              gtable_0.3.6                ##  [93] shapes_1.2.7                sass_0.4.10                 ##  [95] digest_0.6.37               BiocGenerics_0.52.0         ##  [97] SparseArray_1.6.2           htmlwidgets_1.6.4           ##  [99] farver_2.1.2                htmltools_0.5.8.1           ## [101] pkgdown_2.1.3               decorrelate_0.1.6.3         ## [103] lifecycle_1.0.4             httr_1.4.7                  ## [105] MASS_7.3-65"},{"path":"http://GabrielHoffman.github.io/imputez/articles/imputez.html","id":"code","dir":"Articles","previous_headings":"","what":"Code","title":"Imputing z-statistics","text":"","code":"library(imputez) library(GenomicDataStream) library(mvtnorm) library(dplyr)  # VCF file for reference file <- system.file(\"extdata\", \"test.vcf.gz\", package = \"GenomicDataStream\")  # initialize data stream gds = GenomicDataStream(file, \"DS\", initialize=TRUE)  # read genotype data from reference dat = getNextChunk(gds)  # simulate z-statistics with correlation structure # from the LD of the reference panel z = c(rmvnorm(1, rep(0, 10), cor(dat$X)))  # Combine z-statistics with variant ID, position, etc df = dat$info %>%     mutate(z = z, GWAS_A1 = A1, GWAS_A2 = A2) %>%     rename(REF_A1 = A1, REF_A2 = A2)  # Given observed z-statistics and  # GenomicDataStream of reference panel, # Impute z-statistics from variants missing z-statistics. # Here drop variant 2, and then impute its z-statistic # Defaults to run imputezDecorr / decorrelate in the backend res = run_imputez(df[-2,], gds, 10000, 1000)  # Results of imputed z-statistics res ## # A tibble: 1 × 9 ##   ID          A1    A2       z.stat        se  r2.pred lambda    maf nVariants ##   <chr>       <chr> <chr>     <dbl>     <dbl>    <dbl>  <dbl>  <dbl>     <int> ## 1 1:11000:T:C T     C     0.0000602 0.0000291 8.45e-10   1.00 0.0159         9"},{"path":"http://GabrielHoffman.github.io/imputez/articles/imputez.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Imputing z-statistics","text":"","code":"## R version 4.4.2 (2024-10-31) ## Platform: aarch64-apple-darwin23.6.0 ## Running under: macOS Sonoma 14.7.1 ##  ## Matrix products: default ## BLAS:   /Users/gabrielhoffman/prog/R-4.4.2/lib/libRblas.dylib  ## LAPACK: /opt/homebrew/Cellar/r/4.4.3_1/lib/R/lib/libRlapack.dylib;  LAPACK version 3.12.0 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/New_York ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] dplyr_1.1.4              mvtnorm_1.3-3            GenomicDataStream_0.0.17 ## [4] Rdpack_2.6.2             progress_1.2.3           Rcpp_1.0.14              ## [7] imputez_1.2.2            BiocStyle_2.34.0         ##  ## loaded via a namespace (and not attached): ##  [1] xfun_0.51                bslib_0.9.0              htmlwidgets_1.6.4        ##  [4] lattice_0.22-6           vctrs_0.6.5              tools_4.4.2              ##  [7] generics_0.1.3           parallel_4.4.2           rgl_1.3.17               ## [10] tibble_3.2.1             pkgconfig_2.0.3          CovTools_0.5.4           ## [13] Matrix_1.7-2             desc_1.4.3               RcppParallel_5.1.10.9000 ## [16] scatterplot3d_0.3-44     lifecycle_1.0.4          compiler_4.4.2           ## [19] textshaping_1.0.0        minpack.lm_1.2-4         codetools_0.2-20         ## [22] decorrelate_0.1.4        htmltools_0.5.8.1        sass_0.4.9               ## [25] yaml_2.3.10              pracma_2.4.4             pkgdown_2.0.9            ## [28] pillar_1.10.1            crayon_1.5.3             jquerylib_0.1.4          ## [31] MASS_7.3-65              cachem_1.1.0             iterators_1.0.14         ## [34] foreach_1.5.2            tidyselect_1.2.1         digest_0.6.37            ## [37] purrr_1.0.4              bookdown_0.42            ShrinkCovMat_1.4.0       ## [40] fastmap_1.2.0            grid_4.4.2               expm_1.0-0               ## [43] cli_3.6.4                magrittr_2.0.3           base64enc_0.1-3          ## [46] Rfast_2.1.5              corpcor_1.6.10           prettyunits_1.2.0        ## [49] rmarkdown_2.29           shapes_1.2.7             igraph_2.1.4             ## [52] ragg_1.3.3               hms_1.1.3                CholWishart_1.1.4        ## [55] memoise_2.0.1            evaluate_1.0.3           knitr_1.49               ## [58] rbibutils_2.3            SHT_0.1.9                doParallel_1.0.17        ## [61] irlba_2.3.5.1            rlang_1.1.5              zigg_0.0.2               ## [64] glue_1.8.0               flare_1.7.0.2            geigen_2.3               ## [67] BiocManager_1.30.25      jsonlite_1.9.1           R6_2.6.1                 ## [70] systemfonts_1.2.1        fs_1.6.5"},{"path":"http://GabrielHoffman.github.io/imputez/articles/ref_panel.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"1000 Genomes reference panel","text":"","code":"## R version 4.4.2 (2024-10-31) ## Platform: aarch64-apple-darwin23.6.0 ## Running under: macOS Sonoma 14.7.1 ##  ## Matrix products: default ## BLAS:   /Users/gabrielhoffman/prog/R-4.4.2/lib/libRblas.dylib  ## LAPACK: /opt/homebrew/Cellar/r/4.4.3/lib/R/lib/libRlapack.dylib;  LAPACK version 3.12.0 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/New_York ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] BiocStyle_2.34.0 ##  ## loaded via a namespace (and not attached): ##  [1] digest_0.6.37       desc_1.4.3          R6_2.6.1            bookdown_0.42       ##  [5] fastmap_1.2.0       xfun_0.51           cachem_1.1.0        knitr_1.49          ##  [9] htmltools_0.5.8.1   rmarkdown_2.29      lifecycle_1.0.4     cli_3.6.4           ## [13] sass_0.4.9          pkgdown_2.1.1       textshaping_1.0.0   jquerylib_0.1.4     ## [17] systemfonts_1.2.1   compiler_4.4.2      tools_4.4.2         ragg_1.3.3          ## [21] bslib_0.9.0         evaluate_1.0.3      yaml_2.3.10         BiocManager_1.30.25 ## [25] jsonlite_1.9.1      rlang_1.1.5         fs_1.6.5            htmlwidgets_1.6.4"},{"path":"http://GabrielHoffman.github.io/imputez/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gabriel Hoffman. Author, maintainer.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hoffman G (2025). imputez: Impute z-Statistics Missing Variants using Observed z-Statistics Correlation Matrix Variants. R package version 1.2.4, https://GabrielHoffman.github.io/imputez/.","code":"@Manual{,   title = {imputez: Impute z-Statistics for Missing Variants using Observed z-Statistics and Correlation Matrix Between Variants},   author = {Gabriel Hoffman},   year = {2025},   note = {R package version 1.2.4},   url = {https://GabrielHoffman.github.io/imputez/}, }"},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"impute-z-statistics-for-missing-variants-using-observed-z-statistics-and-ld-matrix","dir":"","previous_headings":"","what":"Impute z-statistics for missing variants using observed z-statistics and LD matrix","title":"Impute z-Statistics for Missing Variants using Observed z-Statistics and Correlation Matrix Between Variants","text":"Genome-wide association studies (GWAS) performs tests association across millions genetic variants. imputez package provides series statistical methods impute z-statistic missing genetic variants using LD information reference panel. package achieves high accuracy regularizing LD matrix uses probabilistic whitening transformation implicit covariance scale high-dimensional datasets. standard analysis \\mathcal{O}(p^3) number features, p, package implements algorithm minimum \\mathcal{O}(n p^2) \\mathcal{O}(n^2 p). large number features, can dramatic speedup.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"methods","dir":"","previous_headings":"Impute z-statistics for missing variants using observed z-statistics and LD matrix","what":"Methods","title":"Impute z-Statistics for Missing Variants using Observed z-Statistics and Correlation Matrix Between Variants","text":"imputezDecorr(): scalable imputation using probabilistic whitening transformation implicit covariance implemented decorrelate package. imputez(): standard method comparison cubic time p","code":""},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"installation","dir":"","previous_headings":"Impute z-statistics for missing variants using observed z-statistics and LD matrix","what":"Installation","title":"Impute z-Statistics for Missing Variants using Observed z-Statistics and Correlation Matrix Between Variants","text":"","code":"devtools::install_github(\"GabrielHoffman/imputez\")"},{"path":"http://GabrielHoffman.github.io/imputez/reference/coef_from_z.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute coefficient estimate from z-statistic — coef_from_z","title":"Compute coefficient estimate from z-statistic — coef_from_z","text":"Compute coefficient estimate regression model standard error give z-statistic, sample size standard deviation response covariate","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/coef_from_z.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute coefficient estimate from z-statistic — coef_from_z","text":"","code":"coef_from_z(z, n, sd_x, sd_y, phi)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/coef_from_z.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute coefficient estimate from z-statistic — coef_from_z","text":"z z-statistic n sample size sd_x standard deviation covariate sd_y standard deviation response phi case ratio response logistic regression.  specified, sd_y set phi coefficient transformed logistic scale","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/coef_from_z.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute coefficient estimate from z-statistic — coef_from_z","text":"data.frame storing coef, se, method","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/coef_from_z.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute coefficient estimate from z-statistic — coef_from_z","text":"Given z-statistic, want obtain coefficient value linear regression.  Adapting approach Zhu, et al (2016, Methods eqn 6), estimate coefficient $$\\beta_{linear} = z * sd_y / (sd_x*sqrt(n + z^2)),$$ \\(sd_x\\) standard deviation covariate \\(sd_y\\) standard error response.  model covariates, transformation gives exact coefficient estimate.  covariates, approximate. coeffient estimate linear regression can converted logistic scale using approach Pirinen, et al. (2013) according $$\\beta_{logistic} = \\beta_{linear} / (\\phi(1-\\phi)),$$ \\(\\phi\\) case ratio logistic regression.  approximates coefficient model fit logistic regression.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/coef_from_z.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute coefficient estimate from z-statistic — coef_from_z","text":"Zhu, et al. (2016). Integration summary data GWAS eQTL studies predicts complex trait gene targets. Nature Genetics. 48:481–487 doi:10.1038/ng.3538 Pirinen, Donnelly Spencer. (2013). Efficient computation linear mixed model large-scale data sets applications genetic studies. Ann. Appl. Stat. 7(1): 369-390 doi:10.1214/12-AOAS586","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/coef_from_z.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute coefficient estimate from z-statistic — coef_from_z","text":"","code":"# Linear regression #------------------  # simulate data set.seed(1) n = 100 x = rnorm(n, 0, 7) y = x*3 + rnorm(n) data = data.frame(x, y)  # fit regression model fit <- lm(y ~ x, data=data)  # get z-statistic z = coef(summary(fit))[2,'t value']  # coef and se from regression model coef(summary(fit))[2,-4] #>     Estimate   Std. Error      t value  #>   2.99984852   0.01538958 194.92730329   # coef and se from summary statistics coef_from_z(z, n, sd(x), sd(y)) #>      coef         se method #> 1 2.99977 0.01538917 linear  # Logistic regression #--------------------  # simulate data n = 1000 p = .3 x = rbinom(n, 2, p) eta = x*.1  y = rbinom(n, size=1, prob=plogis(eta)) data = data.frame(x, y)  # fit regression model fit <- glm(y  ~ x, data=data, family=binomial)  # get z-statistic z = coef(summary(fit))[2,3]  # get case ratio  phi = sum(y) / length(y)  # coef and se from regression model coef(summary(fit))[2,] #>   Estimate Std. Error    z value   Pr(>|z|)  #> 0.14614232 0.09590596 1.52380859 0.12755653   # when phi is given, coef is transformed to logistic scale coef_from_z(z, n, sd(x), phi=phi) #>        coef         se   method #> 1 0.1471922 0.09659496 logistic"},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate lambda shrinkage parameter — estimate_lambda","title":"Estimate lambda shrinkage parameter — estimate_lambda","text":"Estimate lambda shrinkage parameter specified method","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate lambda shrinkage parameter — estimate_lambda","text":"","code":"estimate_lambda(   X,   method = c(\"Ledoit-Wolf\", \"OAS\", \"Touloumis\", \"Schafer-Strimmer\") )"},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate lambda shrinkage parameter — estimate_lambda","text":"X matrix features columns method method used estimate lambda shrinkage parameter","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate lambda shrinkage parameter — estimate_lambda","text":"estimated lambda value","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate lambda shrinkage parameter — estimate_lambda","text":"","code":"n <- 100 p <- 400  X <- matrix(rnorm(n*p), n, p)  estimate_lambda(X, \"Ledoit-Wolf\") #> [1] 0.9750712"},{"path":"http://GabrielHoffman.github.io/imputez/reference/impute_region.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute many z-statistics — impute_region","title":"Impute many z-statistics — impute_region","text":"Impute many z-statistics given observed z-statistics reference panel","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/impute_region.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute many z-statistics — impute_region","text":"","code":"impute_region(   df,   gds,   region,   flankWidth,   method = c(\"decorrelate\", \"Ledoit-Wolf\", \"OAS\", \"Touloumis\", \"Schafer-Strimmer\"),   lambda = NULL,   ... )"},{"path":"http://GabrielHoffman.github.io/imputez/reference/impute_region.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute many z-statistics — impute_region","text":"df data.frame columns ID, z, GWAS_A1, GWAS_A2, CHROM, POS REF_A1, REF_A2. gds GenomicDataStream reference panel region genomic region impute flankWidth additional window added region method method used estimate shrinkage parameter lambda.  default \"decorrelate\" lambda (default: NULL) value used shrink correlation matrix. used method \"decorrelate\" ... additional arguments passed imputez() imputezDecorr()","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/impute_region.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute many z-statistics — impute_region","text":"tibble storing imputed results: ID variant identifier z.stat imputed z-statistic sigSq variance imputed z-statistic r2.pred metric accuracy imputed z-statistic based variance lambda shrinkage parameter maf minor allele frequency reference panel nVariants number variants used imputation","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/impute_region.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute many z-statistics — impute_region","text":"","code":"library(GenomicDataStream) library(mvtnorm) library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union  # VCF file for reference file <- system.file(\"extdata\", \"test.vcf.gz\", package = \"GenomicDataStream\")  # initialize data stream gds <- GenomicDataStream(file, \"DS\", initialize=TRUE)  # read genotype data from reference dat <- getNextChunk(gds)  # simulate z-statistics with correlation structure # from the LD of the reference panel set.seed(1) z <- c(rmvnorm(1, rep(0, 10), cor(dat$X)))  # Combine z-statistics with variant ID, position, etc df <- dat$info %>%     mutate(z = z, GWAS_A1 = A1, GWAS_A2 = A2) %>%     rename(REF_A1 = A1, REF_A2 = A2)  # Given observed z-statistics and  # GenomicDataStream of reference panel, # Impute z-statistics from variants missing z-statistics. # Here drop variant 2, and then impute its z-statistic # Impute variants in the given region region <- \"1:1000-100000\" impute_region(df[-2,], gds, region, 1000) #> # A tibble: 1 × 9 #>   ID          A1    A2         z.stat        se  r2.pred lambda    maf nVariants #>   <chr>       <chr> <chr>       <dbl>     <dbl>    <dbl>  <dbl>  <dbl>     <int> #> 1 1:11000:T:C T     C     -0.00000550 0.0000291 8.45e-10  1.000 0.0159         9"},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute z-score based correlations — imputez","title":"Impute z-score based correlations — imputez","text":"Impute z-score missing test based z-scores tests, correlation matrix z-scores","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute z-score based correlations — imputez","text":"","code":"imputez(z, Sigma, i, lambda = 0.1, useginv = FALSE)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute z-score based correlations — imputez","text":"z vector observed z-scores Sigma matrix correlation z-scores index z-scores impute lambda value used shrink correlation matrix useginv TRUE use pseudoinverse","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute z-score based correlations — imputez","text":"data.frame storing: ID variant identifier z.stat imputed z-statistic se standard error imputed z-statistic r2.pred metric accuracy imputed z-statistic based variance lambda shrinkage parameter","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Impute z-score based correlations — imputez","text":"Implements method Pasaniuc, et al. (2014).","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute z-score based correlations — imputez","text":"Pasaniuc, B., Zaitlen, N., Shi, H., Bhatia, G., Gusev, ., Pickrell, J., ... & Price, . L. (2014). Fast accurate imputation summary statistics enhances evidence functional enrichment. Bioinformatics, 30(20), 2906-2914.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute z-score based correlations — imputez","text":"","code":"library(GenomicDataStream) library(mvtnorm)  # VCF file for reference file <- system.file(\"extdata\", \"test.vcf.gz\", package = \"GenomicDataStream\")  # initialize data stream gds <- GenomicDataStream(file, \"DS\", initialize=TRUE)  # read genotype data from reference dat <- getNextChunk(gds)  # simulate z-statistics with correlation structure # from the LD of the reference panel C <- cor(dat$X) set.seed(1) z <- c(rmvnorm(1, rep(0, 10), C)) names(z) <- colnames(dat$X)  # Impute z-statistics for variants 2 and 3  # using the other variants and observed z-statistics # from the reference panel imputez(z, C, 2:3) #>            ID     z.stat        se    r2.pred lambda #> 1 1:11000:T:C -0.2455986 0.2965194 0.08792378    0.1 #> 2 1:12000:T:C -0.2762561 0.3640927 0.13256353    0.1"},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute z-score based correlations — imputezDecorr","title":"Impute z-score based correlations — imputezDecorr","text":"Impute z-score missing test based z-scores tests, genotype matrix","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute z-score based correlations — imputezDecorr","text":"","code":"imputezDecorr(z, X, i, k = min(nrow(X), ncol(X) - length(i)), lambda = NULL)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute z-score based correlations — imputezDecorr","text":"z vector observed z-scores X matrix genotype data reference panel index z-scores impute k rank SVD lambda (default: NULL) value used shrink correlation matrix","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute z-score based correlations — imputezDecorr","text":"data.frame storing: ID variant identifier z.stat imputed z-statistic se standard error imputed z-statistic r2.pred metric accuracy imputed z-statistic based variance lambda shrinkage parameter averageCorrSq average correlation squared X","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Impute z-score based correlations — imputezDecorr","text":"Uses implicit covariance emprical Bayes shrinkage eigen-values accelerate computations. imputez() cubic number features, p, imputezDecorr()  minimum O(n p^2) O(n^2p).  large number features, can dramatic speedup.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute z-score based correlations — imputezDecorr","text":"Pasaniuc, B., Zaitlen, N., Shi, H., Bhatia, G., Gusev, ., Pickrell, J., ... & Price, . L. (2014). Fast accurate imputation summary statistics enhances evidence functional enrichment. Bioinformatics, 30(20), 2906-2914.","code":""},{"path":[]},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute z-score based correlations — imputezDecorr","text":"","code":"library(GenomicDataStream) library(mvtnorm)  # VCF file for reference file <- system.file(\"extdata\", \"test.vcf.gz\", package = \"GenomicDataStream\")  # initialize data stream gds <- GenomicDataStream(file, \"DS\", initialize=TRUE)  # read genotype data from reference dat <- getNextChunk(gds)  # simulate z-statistics with correlation structure # from the LD of the reference panel C <- cor(dat$X) set.seed(1) z <- c(rmvnorm(1, rep(0, 10), C)) names(z) <- colnames(dat$X)  # Impute z-statistics for variants 2 and 3  # using the other variants and observed z-statistics # from the reference panel # Use dat$X directly instead of creating cor(dat$X) imputezDecorr(z, dat$X, 2:3) #>            ID        z.stat           se      r2.pred lambda averageCorrSq #> 1 1:11000:T:C -1.689124e-05 2.890456e-05 8.354737e-10 0.9999  2.012952e-10 #> 2 1:12000:T:C -2.216518e-05 3.287110e-05 1.080509e-09 0.9999  2.012952e-10"},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputability.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate imputation quality — run_imputability","title":"Evaluate imputation quality — run_imputability","text":"Evaluate","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate imputation quality — run_imputability","text":"","code":"run_imputability(   df,   gds,   window,   flankWidth,   ids,   method = c(\"decorrelate\", \"Ledoit-Wolf\", \"OAS\", \"Touloumis\", \"Schafer-Strimmer\"),   lambda = NULL,   quiet = FALSE,   ... )"},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate imputation quality — run_imputability","text":"df data.frame columns ID,  CHROM, POS gds GenomicDataStream reference panel window size window bp flankWidth additional window added region ids variant IDs evaluate imputation r2 score method method used estimate shrinkage parameter lambda.  default \"decorrelate\" lambda (default: NULL) value used shrink correlation matrix. used method \"decorrelate\" quiet suppress messages ... additional arguments passed impute_region()","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate imputation quality — run_imputability","text":"tibble storing imputed results: ID variant identifier r2.pred metric accuracy imputed z-statistic based variance lambda shrinkage parameter maf minor allele frequency reference panel nVariants number variants used imputation","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputability.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Evaluate imputation quality — run_imputability","text":"Implements method Pasaniuc, et al. (2014).","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputability.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Evaluate imputation quality — run_imputability","text":"Pasaniuc, B., Zaitlen, N., Shi, H., Bhatia, G., Gusev, ., Pickrell, J., ... & Price, . L. (2014). Fast accurate imputation summary statistics enhances evidence functional enrichment. Bioinformatics, 30(20), 2906-2914.","code":""},{"path":[]},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputability.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluate imputation quality — run_imputability","text":"","code":"library(GenomicDataStream) library(tidyverse) #> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ── #> ✔ forcats   1.0.0     ✔ readr     2.1.5 #> ✔ ggplot2   3.5.2     ✔ stringr   1.5.1 #> ✔ lubridate 1.9.4     ✔ tibble    3.3.0 #> ✔ purrr     1.1.0     ✔ tidyr     1.3.1 #> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ── #> ✖ dplyr::filter() masks stats::filter() #> ✖ dplyr::lag()    masks stats::lag() #> ℹ Use the conflicted package to force all conflicts to become errors  # VCF file for reference file <- system.file(\"extdata\", \"test.vcf.gz\", package = \"GenomicDataStream\")  # initialize data stream gds <- GenomicDataStream(file, \"DS\", initialize=TRUE)  # read file of variant locations file <- system.file(\"extdata\", \"test.map\", package = \"GenomicDataStream\") df = read_tsv(file) #> Rows: 10 Columns: 5 #> ── Column specification ──────────────────────────────────────────────────────── #> Delimiter: \"\\t\" #> chr (3): ID, A1, A2 #> dbl (2): CHROM, POS #>  #> ℹ Use `spec()` to retrieve the full column specification for this data. #> ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.  # evaluate imputation r2 for these variants ids = df$ID[c(1,9)]  # Given GenomicDataStream of reference panel, # compute imputation r2 for variants in ids run_imputability(df, gds, 10000, 1000, ids) #> # A tibble: 2 × 5 #> # Groups:   ID [2] #>   ID                r2.pred lambda   maf nVariants #>   <chr>               <dbl>  <dbl> <dbl>     <int> #> 1 1:10000:C:A 0.00000000238  1.000 0.347         8 #> 2 1:18000:C:G 0.00000000137  1.000 0.265         8"},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute many z-statistics — run_imputez","title":"Impute many z-statistics — run_imputez","text":"Impute many z-statistics given observed z-statistics reference panel","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute many z-statistics — run_imputez","text":"","code":"run_imputez(   df,   gds,   window,   flankWidth,   method = c(\"decorrelate\", \"Ledoit-Wolf\", \"OAS\", \"Touloumis\", \"Schafer-Strimmer\"),   lambda = NULL,   quiet = FALSE,   ... )"},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute many z-statistics — run_imputez","text":"df data.frame columns ID, z, GWAS_A1, GWAS_A2, CHROM, POS A1, A2. gds GenomicDataStream reference panel window size window bp flankWidth additional window added region method method used estimate shrinkage parameter lambda.  default \"decorrelate\" lambda (default: NULL) value used shrink correlation matrix. used method \"decorrelate\" quiet suppress messages ... additional arguments passed impute_region()","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute many z-statistics — run_imputez","text":"tibble storing imputed results: ID variant identifier z.stat imputed z-statistic sigSq variance imputed z-statistic r2.pred metric accuracy imputed z-statistic based variance lambda shrinkage parameter maf minor allele frequency reference panel nVariants number variants used imputation","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Impute many z-statistics — run_imputez","text":"Implements method Pasaniuc, et al. (2014).","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute many z-statistics — run_imputez","text":"Pasaniuc, B., Zaitlen, N., Shi, H., Bhatia, G., Gusev, ., Pickrell, J., ... & Price, . L. (2014). Fast accurate imputation summary statistics enhances evidence functional enrichment. Bioinformatics, 30(20), 2906-2914.","code":""},{"path":[]},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute many z-statistics — run_imputez","text":"","code":"library(GenomicDataStream) library(mvtnorm) library(dplyr)  # VCF file for reference file <- system.file(\"extdata\", \"test.vcf.gz\", package = \"GenomicDataStream\")  # initialize data stream gds <- GenomicDataStream(file, \"DS\", initialize=TRUE)  # read genotype data from reference dat <- getNextChunk(gds)  # simulate z-statistics with correlation structure # from the LD of the reference panel set.seed(1) z <- c(rmvnorm(1, rep(0, 10), cor(dat$X)))  # Combine z-statistics with variant ID, position, etc df <- dat$info %>%     mutate(z = z, GWAS_A1 = A1, GWAS_A2 = A2) %>%     rename(REF_A1 = A1, REF_A2 = A2)  # Given observed z-statistics and  # GenomicDataStream of reference panel, # Impute z-statistics from variants missing z-statistics. # Here drop variant 2, and then impute its z-statistic res <- run_imputez(df[-2,], gds, 10000, 1000)  # Results of imputed z-statistics res #> # A tibble: 1 × 9 #>   ID          A1    A2         z.stat        se  r2.pred lambda    maf nVariants #>   <chr>       <chr> <chr>       <dbl>     <dbl>    <dbl>  <dbl>  <dbl>     <int> #> 1 1:11000:T:C T     C     -0.00000550 0.0000291 8.45e-10  1.000 0.0159         9"}]
