[{"path":"http://GabrielHoffman.github.io/imputez/articles/imputez.html","id":"code","dir":"Articles","previous_headings":"","what":"Code","title":"Imputing z-statistics","text":"","code":"library(imputez) library(GenomicDataStream) library(mvtnorm) library(dplyr)  # VCF file for reference file <- system.file(\"extdata\", \"test.vcf.gz\", package = \"GenomicDataStream\")  # initialize data stream gds = GenomicDataStream(file, \"DS\", initialize=TRUE)  # read genotype data from reference dat = getNextChunk(gds)  # simulate z-statistics with correlation structure # from the LD of the reference panel z = c(rmvnorm(1, rep(0, 10), cor(dat$X)))  # Combine z-statistics with variant ID, position, etc df = dat$info %>%     mutate(z = z, GWAS_A1 = A1, GWAS_A2 = A2) %>%     rename(REF_A1 = A1, REF_A2 = A2)  # Given observed z-statistics and  # GenomicDataStream of reference panel, # Impute z-statistics from variants missing z-statistics. # Here drop variant 2, and then impute its z-statistic # Defaults to run imputezDecorr / decorrelate in the backend res = run_imputez(df[-2,], gds, 10000, 1000)  # Results of imputed z-statistics res ## # A tibble: 1 √ó 9 ##   ID          A1    A2       z.stat        se  r2.pred lambda    maf nVariants ##   <chr>       <chr> <chr>     <dbl>     <dbl>    <dbl>  <dbl>  <dbl>     <int> ## 1 1:11000:T:C T     C     0.0000602 0.0000291 8.45e-10   1.00 0.0159         9"},{"path":"http://GabrielHoffman.github.io/imputez/articles/imputez.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Imputing z-statistics","text":"","code":"## R version 4.4.2 (2024-10-31) ## Platform: aarch64-apple-darwin23.6.0 ## Running under: macOS Sonoma 14.7.1 ##  ## Matrix products: default ## BLAS:   /Users/gabrielhoffman/prog/R-4.4.2/lib/libRblas.dylib  ## LAPACK: /opt/homebrew/Cellar/r/4.4.3_1/lib/R/lib/libRlapack.dylib;  LAPACK version 3.12.0 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/New_York ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] dplyr_1.1.4              mvtnorm_1.3-3            GenomicDataStream_0.0.17 ## [4] Rdpack_2.6.2             progress_1.2.3           Rcpp_1.0.14              ## [7] imputez_1.2.2            BiocStyle_2.34.0         ##  ## loaded via a namespace (and not attached): ##  [1] xfun_0.51                bslib_0.9.0              htmlwidgets_1.6.4        ##  [4] lattice_0.22-6           vctrs_0.6.5              tools_4.4.2              ##  [7] generics_0.1.3           parallel_4.4.2           rgl_1.3.17               ## [10] tibble_3.2.1             pkgconfig_2.0.3          CovTools_0.5.4           ## [13] Matrix_1.7-2             desc_1.4.3               RcppParallel_5.1.10.9000 ## [16] scatterplot3d_0.3-44     lifecycle_1.0.4          compiler_4.4.2           ## [19] textshaping_1.0.0        minpack.lm_1.2-4         codetools_0.2-20         ## [22] decorrelate_0.1.4        htmltools_0.5.8.1        sass_0.4.9               ## [25] yaml_2.3.10              pracma_2.4.4             pkgdown_2.0.9            ## [28] pillar_1.10.1            crayon_1.5.3             jquerylib_0.1.4          ## [31] MASS_7.3-65              cachem_1.1.0             iterators_1.0.14         ## [34] foreach_1.5.2            tidyselect_1.2.1         digest_0.6.37            ## [37] purrr_1.0.4              bookdown_0.42            ShrinkCovMat_1.4.0       ## [40] fastmap_1.2.0            grid_4.4.2               expm_1.0-0               ## [43] cli_3.6.4                magrittr_2.0.3           base64enc_0.1-3          ## [46] Rfast_2.1.5              corpcor_1.6.10           prettyunits_1.2.0        ## [49] rmarkdown_2.29           shapes_1.2.7             igraph_2.1.4             ## [52] ragg_1.3.3               hms_1.1.3                CholWishart_1.1.4        ## [55] memoise_2.0.1            evaluate_1.0.3           knitr_1.49               ## [58] rbibutils_2.3            SHT_0.1.9                doParallel_1.0.17        ## [61] irlba_2.3.5.1            rlang_1.1.5              zigg_0.0.2               ## [64] glue_1.8.0               flare_1.7.0.2            geigen_2.3               ## [67] BiocManager_1.30.25      jsonlite_1.9.1           R6_2.6.1                 ## [70] systemfonts_1.2.1        fs_1.6.5"},{"path":"http://GabrielHoffman.github.io/imputez/articles/ref_panel.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"1000 Genomes reference panel","text":"","code":"## R version 4.4.2 (2024-10-31) ## Platform: aarch64-apple-darwin23.6.0 ## Running under: macOS Sonoma 14.7.1 ##  ## Matrix products: default ## BLAS:   /Users/gabrielhoffman/prog/R-4.4.2/lib/libRblas.dylib  ## LAPACK: /opt/homebrew/Cellar/r/4.4.3/lib/R/lib/libRlapack.dylib;  LAPACK version 3.12.0 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/New_York ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] BiocStyle_2.34.0 ##  ## loaded via a namespace (and not attached): ##  [1] digest_0.6.37       desc_1.4.3          R6_2.6.1            bookdown_0.42       ##  [5] fastmap_1.2.0       xfun_0.51           cachem_1.1.0        knitr_1.49          ##  [9] htmltools_0.5.8.1   rmarkdown_2.29      lifecycle_1.0.4     cli_3.6.4           ## [13] sass_0.4.9          pkgdown_2.1.1       textshaping_1.0.0   jquerylib_0.1.4     ## [17] systemfonts_1.2.1   compiler_4.4.2      tools_4.4.2         ragg_1.3.3          ## [21] bslib_0.9.0         evaluate_1.0.3      yaml_2.3.10         BiocManager_1.30.25 ## [25] jsonlite_1.9.1      rlang_1.1.5         fs_1.6.5            htmlwidgets_1.6.4"},{"path":"http://GabrielHoffman.github.io/imputez/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gabriel Hoffman. Author, maintainer.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hoffman G (2025). imputez: Impute z-Statistics Missing Variants using Observed z-Statistics Correlation Matrix Variants. R package version 1.2.3, https://GabrielHoffman.github.io/imputez.","code":"@Manual{,   title = {imputez: Impute z-Statistics for Missing Variants using Observed z-Statistics and Correlation Matrix Between Variants},   author = {Gabriel Hoffman},   year = {2025},   note = {R package version 1.2.3},   url = {https://GabrielHoffman.github.io/imputez}, }"},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"impute-z-statistics-for-missing-variants-using-observed-z-statistics-and-ld-matrix","dir":"","previous_headings":"","what":"Impute z-statistics for missing variants using observed z-statistics and LD matrix","title":"Impute z-Statistics for Missing Variants using Observed z-Statistics and Correlation Matrix Between Variants","text":"Genome-wide association studies (GWAS) performs tests association across millions genetic variants. imputez package provides series statistical methods impute z-statistic missing genetic variants using LD information reference panel. package achieves high accuracy regularizing LD matrix uses probabilistic whitening transformation implicit covariance scale high-dimensional datasets. standard analysis ùí™(p3) number features, p, package implements algorithm minimum ùí™(np2) ùí™(n2p). large number features, can dramatic speedup.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"methods","dir":"","previous_headings":"Impute z-statistics for missing variants using observed z-statistics and LD matrix","what":"Methods","title":"Impute z-Statistics for Missing Variants using Observed z-Statistics and Correlation Matrix Between Variants","text":"imputezDecorr(): scalable imputation using probabilistic whitening transformation implicit covariance implemented decorrelate package. imputez(): standard method comparison cubic time p","code":""},{"path":"http://GabrielHoffman.github.io/imputez/index.html","id":"installation","dir":"","previous_headings":"Impute z-statistics for missing variants using observed z-statistics and LD matrix","what":"Installation","title":"Impute z-Statistics for Missing Variants using Observed z-Statistics and Correlation Matrix Between Variants","text":"","code":"devtools::install_github(\"GabrielHoffman/imputez\")"},{"path":"http://GabrielHoffman.github.io/imputez/reference/coef_from_z.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute coefficient estimate from z-statistic ‚Äî coef_from_z","title":"Compute coefficient estimate from z-statistic ‚Äî coef_from_z","text":"Compute coefficient estimate regression model standard error give z-statistic, sample size standard deviation response covariate","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/coef_from_z.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute coefficient estimate from z-statistic ‚Äî coef_from_z","text":"","code":"coef_from_z(z, n, sd_x, sd_y, phi)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/coef_from_z.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute coefficient estimate from z-statistic ‚Äî coef_from_z","text":"z z-statistic n sample size sd_x standard deviation covariate sd_y standard deviation response phi case ratio response logistic regression.  specified, sd_y set phi coefficient transformed logistic scale","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/coef_from_z.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute coefficient estimate from z-statistic ‚Äî coef_from_z","text":"Given z-statistic, want obtain coefficient value linear regression.  Adapting approach Zhu, et al (2016, Methods eqn 6), estimate coefficient $$\\beta = z * sd_y / (sd_x*sqrt(n + z^2)),$$ \\(sd_x\\) standard deviation covariate \\(sd_y\\) standard error response.  model covariates, transformation gives exact coefficient estimate.  covariates, approximate. Second, coeffient estimate linear regression can converted logistic scale using approach Pirinen, et al. (2013) according $$\\beta / (\\phi(1-\\phi)),$$ \\(\\phi\\) case ratio logistic regression.  approximates coefficient model fit logistic regression.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/coef_from_z.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute coefficient estimate from z-statistic ‚Äî coef_from_z","text":"Zhu, et al. (2016). Integration summary data GWAS eQTL studies predicts complex trait gene targets. Nature Genetics. 48:481‚Äì487 https://doi.org/10.1038/ng.3538 Pirinen, Donnelly Spencer. (2013). Efficient computation linear mixed model large-scale data sets applications genetic studies. Ann. Appl. Stat. 7(1): 369-390  https://doi.org/10.1214/12-AOAS586","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/coef_from_z.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute coefficient estimate from z-statistic ‚Äî coef_from_z","text":"","code":"# Linear regression #------------------  # simulate data set.seed(1) n = 100 x = rnorm(n, 0, 7) y = x*3 + rnorm(n) data = data.frame(x, y)  # fit regression model fit <- lm(y ~ x, data=data)  # get z-statistic z = coef(summary(fit))[2,'t value']  # coef and se from regression model coef(summary(fit))[2,-4] #>     Estimate   Std. Error      t value  #>   2.99984852   0.01538958 194.92730329   # coef and se from summary statistics coef_from_z(z, n, sd(x), sd(y)) #>      coef         se method #> 1 2.99977 0.01538917 linear  # Logistic regression #--------------------  # simulate data n = 1000 p = .3 x = rbinom(n, 2, p) eta = x*.1  y = rbinom(n, size=1, prob=plogis(eta)) data = data.frame(x, y)  # fit regression model fit <- glm(y  ~ x, data=data, family=binomial)  # get z-statistic z = coef(summary(fit))[2,3]  # get case ratio  phi = sum(y) / length(y)  # coef and se from regression model coef(summary(fit))[2,] #>   Estimate Std. Error    z value   Pr(>|z|)  #> 0.14614232 0.09590596 1.52380859 0.12755653   # when phi is given, coef is transformed to logistic scale coef_from_z(z, n, sd(x), phi=phi) #>        coef         se   method #> 1 0.1471922 0.09659496 logistic"},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate lambda shrinkage parameter ‚Äî estimate_lambda","title":"Estimate lambda shrinkage parameter ‚Äî estimate_lambda","text":"Estimate lambda shrinkage parameter specified method","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate lambda shrinkage parameter ‚Äî estimate_lambda","text":"","code":"estimate_lambda(   X,   method = c(\"Ledoit-Wolf\", \"OAS\", \"Touloumis\", \"Schafer-Strimmer\") )"},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate lambda shrinkage parameter ‚Äî estimate_lambda","text":"X matrix features columns method method used estimate lambda shrinkage parameter","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate lambda shrinkage parameter ‚Äî estimate_lambda","text":"estimated lambda value","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/estimate_lambda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate lambda shrinkage parameter ‚Äî estimate_lambda","text":"","code":"n <- 100 p <- 400  X <- matrix(rnorm(n*p), n, p)  estimate_lambda(X, \"Ledoit-Wolf\") #> [1] 0.9757727"},{"path":"http://GabrielHoffman.github.io/imputez/reference/impute_region.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute many z-statistics ‚Äî impute_region","title":"Impute many z-statistics ‚Äî impute_region","text":"Impute many z-statistics given observed z-statistics reference panel","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/impute_region.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute many z-statistics ‚Äî impute_region","text":"","code":"impute_region(   df,   gds,   region,   flankWidth,   method = c(\"decorrelate\", \"Ledoit-Wolf\", \"OAS\", \"Touloumis\", \"Schafer-Strimmer\"),   lambda = NULL,   ... )"},{"path":"http://GabrielHoffman.github.io/imputez/reference/impute_region.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute many z-statistics ‚Äî impute_region","text":"df data.frame columns ID, z, GWAS_A1, GWAS_A2, CHROM, POS REF_A1, REF_A2. gds GenomicDataStream reference panel region genomic region impute flankWidth additional window added region method method used estimate shrinkage parameter lambda.  default \"decorrelate\" lambda (default: NULL) value used shrink correlation matrix. used method \"decorrelate\" ... additional arguments passed imputez() imputezDecorr()","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/impute_region.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute many z-statistics ‚Äî impute_region","text":"tibble storing imputed results: ID variant identifier z.stat imputed z-statistic sigSq variance imputed z-statistic r2.pred metric accuracy imputed z-statistic based variance lambda shrinkage parameter maf minor allele frequency reference panel nVariants number variants used imputation","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/impute_region.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute many z-statistics ‚Äî impute_region","text":"","code":"library(GenomicDataStream) #> Loading required package: Rcpp #> Loading required package: progress #> Loading required package: Rdpack library(mvtnorm) library(dplyr) #>  #> Attaching package: ‚Äòdplyr‚Äô #> The following objects are masked from ‚Äòpackage:stats‚Äô: #>  #>     filter, lag #> The following objects are masked from ‚Äòpackage:base‚Äô: #>  #>     intersect, setdiff, setequal, union  # VCF file for reference file <- system.file(\"extdata\", \"test.vcf.gz\", package = \"GenomicDataStream\")  # initialize data stream gds <- GenomicDataStream(file, \"DS\", initialize=TRUE)  # read genotype data from reference dat <- getNextChunk(gds)  # simulate z-statistics with correlation structure # from the LD of the reference panel set.seed(1) z <- c(rmvnorm(1, rep(0, 10), cor(dat$X)))  # Combine z-statistics with variant ID, position, etc df <- dat$info %>%     mutate(z = z, GWAS_A1 = A1, GWAS_A2 = A2) %>%     rename(REF_A1 = A1, REF_A2 = A2)  # Given observed z-statistics and  # GenomicDataStream of reference panel, # Impute z-statistics from variants missing z-statistics. # Here drop variant 2, and then impute its z-statistic # Impute variants in the given region region <- \"1:1000-100000\" impute_region(df[-2,], gds, region, 1000) #> # A tibble: 1 √ó 9 #>   ID          A1    A2         z.stat        se  r2.pred lambda    maf nVariants #>   <chr>       <chr> <chr>       <dbl>     <dbl>    <dbl>  <dbl>  <dbl>     <int> #> 1 1:11000:T:C T     C     -0.00000550 0.0000291 8.45e-10   1.00 0.0159         9"},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute z-score based correlations ‚Äî imputez","title":"Impute z-score based correlations ‚Äî imputez","text":"Impute z-score missing test based z-scores tests, correlation matrix z-scores","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute z-score based correlations ‚Äî imputez","text":"","code":"imputez(z, Sigma, i, lambda = 0.1, useginv = FALSE)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute z-score based correlations ‚Äî imputez","text":"z vector observed z-scores Sigma matrix correlation z-scores index z-scores impute lambda value used shrink correlation matrix useginv TRUE use pseudoinverse","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute z-score based correlations ‚Äî imputez","text":"data.frame storing: ID variant identifier z.stat imputed z-statistic se standard error imputed z-statistic r2.pred metric accuracy imputed z-statistic based variance lambda shrinkage parameter","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Impute z-score based correlations ‚Äî imputez","text":"Implements method Pasaniuc, et al. (2014).","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute z-score based correlations ‚Äî imputez","text":"Pasaniuc, B., Zaitlen, N., Shi, H., Bhatia, G., Gusev, ., Pickrell, J., ... & Price, . L. (2014). Fast accurate imputation summary statistics enhances evidence functional enrichment. Bioinformatics, 30(20), 2906-2914.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputez.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute z-score based correlations ‚Äî imputez","text":"","code":"library(GenomicDataStream) library(mvtnorm)  # VCF file for reference file <- system.file(\"extdata\", \"test.vcf.gz\", package = \"GenomicDataStream\")  # initialize data stream gds <- GenomicDataStream(file, \"DS\", initialize=TRUE)  # read genotype data from reference dat <- getNextChunk(gds)  # simulate z-statistics with correlation structure # from the LD of the reference panel C <- cor(dat$X) set.seed(1) z <- c(rmvnorm(1, rep(0, 10), C)) names(z) <- colnames(dat$X)  # Impute z-statistics for variants 2 and 3  # using the other variants and observed z-statistics # from the reference panel imputez(z, C, 2:3) #>            ID     z.stat        se    r2.pred lambda #> 1 1:11000:T:C -0.2455986 0.2965194 0.08792378    0.1 #> 2 1:12000:T:C -0.2762561 0.3640927 0.13256353    0.1"},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute z-score based correlations ‚Äî imputezDecorr","title":"Impute z-score based correlations ‚Äî imputezDecorr","text":"Impute z-score missing test based z-scores tests, genotype matrix","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute z-score based correlations ‚Äî imputezDecorr","text":"","code":"imputezDecorr(z, X, i, k = min(nrow(X), ncol(X) - length(i)), lambda = NULL)"},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute z-score based correlations ‚Äî imputezDecorr","text":"z vector observed z-scores X matrix genotype data reference panel index z-scores impute k rank SVD lambda (default: NULL) value used shrink correlation matrix","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute z-score based correlations ‚Äî imputezDecorr","text":"data.frame storing: ID variant identifier z.stat imputed z-statistic se standard error imputed z-statistic r2.pred metric accuracy imputed z-statistic based variance lambda shrinkage parameter averageCorrSq average correlation squared X","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Impute z-score based correlations ‚Äî imputezDecorr","text":"Uses implicit covariance emprical Bayes shrinkage eigen-values accelerate computations. imputez() cubic number features, p, imputezDecorr()  minimum O(n p^2) O(n^2p).  large number features, can dramatic speedup.","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute z-score based correlations ‚Äî imputezDecorr","text":"Pasaniuc, B., Zaitlen, N., Shi, H., Bhatia, G., Gusev, ., Pickrell, J., ... & Price, . L. (2014). Fast accurate imputation summary statistics enhances evidence functional enrichment. Bioinformatics, 30(20), 2906-2914.","code":""},{"path":[]},{"path":"http://GabrielHoffman.github.io/imputez/reference/imputezDecorr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute z-score based correlations ‚Äî imputezDecorr","text":"","code":"library(GenomicDataStream) library(mvtnorm)  # VCF file for reference file <- system.file(\"extdata\", \"test.vcf.gz\", package = \"GenomicDataStream\")  # initialize data stream gds <- GenomicDataStream(file, \"DS\", initialize=TRUE)  # read genotype data from reference dat <- getNextChunk(gds)  # simulate z-statistics with correlation structure # from the LD of the reference panel C <- cor(dat$X) set.seed(1) z <- c(rmvnorm(1, rep(0, 10), C)) names(z) <- colnames(dat$X)  # Impute z-statistics for variants 2 and 3  # using the other variants and observed z-statistics # from the reference panel # Use dat$X directly instead of creating cor(dat$X) imputezDecorr(z, dat$X, 2:3) #>            ID        z.stat           se      r2.pred lambda averageCorrSq #> 1 1:11000:T:C -1.689124e-05 2.890456e-05 8.354737e-10 0.9999  2.012952e-10 #> 2 1:12000:T:C -2.216518e-05 3.287110e-05 1.080509e-09 0.9999  2.012952e-10"},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute many z-statistics ‚Äî run_imputez","title":"Impute many z-statistics ‚Äî run_imputez","text":"Impute many z-statistics given observed z-statistics reference panel","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute many z-statistics ‚Äî run_imputez","text":"","code":"run_imputez(   df,   gds,   window,   flankWidth,   method = c(\"decorrelate\", \"Ledoit-Wolf\", \"OAS\", \"Touloumis\", \"Schafer-Strimmer\"),   lambda = NULL,   quiet = FALSE,   ... )"},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute many z-statistics ‚Äî run_imputez","text":"df data.frame columns ID, z, GWAS_A1, GWAS_A2, CHROM, POS A1, A2. gds GenomicDataStream reference panel window size window bp flankWidth additional window added region method method used estimate shrinkage parameter lambda.  default \"decorrelate\" lambda (default: NULL) value used shrink correlation matrix. used method \"decorrelate\" quiet suppress messages ... additional arguments passed impute_region()","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute many z-statistics ‚Äî run_imputez","text":"tibble storing imputed results: ID variant identifier z.stat imputed z-statistic sigSq variance imputed z-statistic r2.pred metric accuracy imputed z-statistic based variance lambda shrinkage parameter maf minor allele frequency reference panel nVariants number variants used imputation","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Impute many z-statistics ‚Äî run_imputez","text":"Implements method Pasaniuc, et al. (2014).","code":""},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Impute many z-statistics ‚Äî run_imputez","text":"Pasaniuc, B., Zaitlen, N., Shi, H., Bhatia, G., Gusev, ., Pickrell, J., ... & Price, . L. (2014). Fast accurate imputation summary statistics enhances evidence functional enrichment. Bioinformatics, 30(20), 2906-2914.","code":""},{"path":[]},{"path":"http://GabrielHoffman.github.io/imputez/reference/run_imputez.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute many z-statistics ‚Äî run_imputez","text":"","code":"library(GenomicDataStream) library(mvtnorm) library(dplyr)  # VCF file for reference file <- system.file(\"extdata\", \"test.vcf.gz\", package = \"GenomicDataStream\")  # initialize data stream gds <- GenomicDataStream(file, \"DS\", initialize=TRUE)  # read genotype data from reference dat <- getNextChunk(gds)  # simulate z-statistics with correlation structure # from the LD of the reference panel set.seed(1) z <- c(rmvnorm(1, rep(0, 10), cor(dat$X)))  # Combine z-statistics with variant ID, position, etc df <- dat$info %>%     mutate(z = z, GWAS_A1 = A1, GWAS_A2 = A2) %>%     rename(REF_A1 = A1, REF_A2 = A2)  # Given observed z-statistics and  # GenomicDataStream of reference panel, # Impute z-statistics from variants missing z-statistics. # Here drop variant 2, and then impute its z-statistic res <- run_imputez(df[-2,], gds, 10000, 1000)  # Results of imputed z-statistics res #> # A tibble: 1 √ó 9 #>   ID          A1    A2         z.stat        se  r2.pred lambda    maf nVariants #>   <chr>       <chr> <chr>       <dbl>     <dbl>    <dbl>  <dbl>  <dbl>     <int> #> 1 1:11000:T:C T     C     -0.00000550 0.0000291 8.45e-10   1.00 0.0159         9"}]
